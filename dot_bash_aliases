if [ -f ~/.bash_envs ]; then
    . ~/.bash_envs
fi

alias cz=chezmoi

function change_ws() {
CUR=$PWD
while [ $CUR != $HOME ]; do
     if [ -f $CUR/devel/setup.bash ]; then
         export CATKIN_WORKSPACE=$CUR
         export USER_PACKAGE_PATH=$CATKIN_WORKSPACE/devel
         source $USER_PACKAGE_PATH/setup.bash
         echo â€œROS workspace: $CURâ€
         break
     fi
     CUR=`readlink -f $CUR/..`
done
}

function ssh() {
  # tmuxèµ·å‹•æ™‚
  trap "tmux select-pane -P 'bg=default'" INT EXIT TERM
  if [[ -n $(printenv TMUX) ]] ; then
      # ç¾åœ¨ã®ãƒšã‚¤ãƒ³IDã‚’è¨˜éŒ²
      local pane_id=$(tmux display -p '#{pane_id}')
      # æŽ¥ç¶šå…ˆãƒ›ã‚¹ãƒˆåã«å¿œã˜ã¦èƒŒæ™¯è‰²ã‚’åˆ‡ã‚Šæ›¿ãˆ
      tmux select-pane -P 'bg=#04376F'

      # é€šå¸¸é€šã‚Šsshç¶šè¡Œ
      command ssh $@

      # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®èƒŒæ™¯è‰²ã«æˆ»ã™
      tmux select-pane -t $pane_id -P 'default'
  else
      command ssh $@
  fi
}
#----
function parse_git_branch {
    git branch --no-color 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ [\1]/'
}
function promps {
    local  BLUE="\[\e[1;34m\]"
    local  RED="\[\e[1;31m\]"
    local  GREEN="\[\e[1;32m\]"
    local  YELLOW="\[\e[1;33m\]"
    local  WHITE="\[\e[00m\]"
    local  GRAY="\[\e[1;37m\]"

    case $TERM in
        xterm*) TITLEBAR='\[\e]0;\W\007\]';;
        *)      TITLEBAR="";;
    esac
    local BASE="\u@\h"
    if [[ -n "$DOCKER_CONTAINER_NAME" ]]; then
        PS1="ðŸ³ \e[0;34m$DOCKER_CONTAINER_NAME\e[0m \w ${RED}\$(parse_git_branch)${BLUE}\$${WHITE} \n"
    else
        PS1="${TITLEBAR}${GREEN}${BASE}${WHITE}:${BLUE}\w${RED}\$(parse_git_branch)${BLUE}\$${WHITE} \n"
    fi 
}
promps
#----
ffmpeg_to_gif(){
  ffmpeg -i $1 -filter_complex "[0:v] fps=10,scale=640:-1,split [a][b];[a] palettegen [p];[b][p] paletteuse" $2
}

ide()
{
    tmux split-window -v -p 30
    tmux split-window -h -p 66
    tmux split-window -h -p 50
}
function share_history {
 history -a
  # tac ~/.bash_history | awk '!a[$0]++' | tac > ~/.bash_history.tmp
  # [ -f ~/.bash_history.tmp ] &&
   # cp ~/.bash_history{.tmp,} &&
 history -c
 history -r
}
function clean_history {
  history -a
  tac ~/.bash_history | awk '!a[$0]++' | tac > ~/.bash_history.tmp
  [ -f ~/.bash_history.tmp ] &&
    mv ~/.bash_history{.tmp,} &&
    history -c &&
    history -r
}
PROMPT_COMMAND='share_history'
